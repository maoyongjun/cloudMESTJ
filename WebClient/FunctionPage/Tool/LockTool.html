<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Locking tool</title>
    <link href="../../css/bootstrap.min.css" rel="stylesheet" />
    <link href="../../css/font-awesome.css" rel="stylesheet" />
    <link href="../../css/animate.css" rel="stylesheet" />
    <link href="../../css/style.css" rel="stylesheet" />
    <link href="../../css/plugins/bootstrapTable/bootstrap-table.min.css" rel="stylesheet" />
    <link href="../../css/plugins/sweetalert/sweetalert.css" rel="stylesheet" />
    <style>
    </style>
</head>
<body class="full-height">
    <div class="panel-heading bg-primary">
        <h3><i class="glyphicon glyphicon-tags"></i><span style="padding-left:10px;" set-lan="html:LookingTool">Looking Tool</span></h3>
    </div>
    <div class="panel-body full-height">
        <div id="divQueryConditions" class=" row form-horizontal">
            <div class="col-xs-12 col-sm-12 col-md-10 col-lg-8">
                <div id="divQueryType" class="form-group col-xs-12 col-sm-6 col-md-6 col-lg-6">
                    <label class="col-xs-3 col-sm-3 col-md-3 col-lg-3 control-label text-right" set-lan="html:labelQueryType">Type:</label>
                    <div class="col-xs-9 col-sm-9 col-md-9 col-lg-9">
                        <label class="radio-inline">
                            <input type="radio" name="QueryType" value="ByWo" checked> By WO
                        </label>
                        <label class="radio-inline">
                            <input type="radio" name="QueryType" value="ByLot">By Lot
                        </label>
                        <label class="radio-inline">
                            <input type="radio" name="QueryType" value="BySn"> By SN
                        </label>
                    </div>
                </div>
                <div id="divQueryStatus">
                    <div class="form-group col-xs-12 col-sm-6 col-md-6 col-lg-6">
                        <label class="col-xs-3 col-sm-3 col-md-3 col-lg-3 control-label text-right" set-lan="html:labelLockStauts">Status:</label>
                        <div class="col-xs-9 col-sm-9 col-md-9 col-lg-9">
                            <select class="form-control">
                                <option value="ALL" selected>All</option>
                                <option value="0">Lock</option>
                                <option value="1">UnLock</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-xs-12 col-sm-12 col-md-10 col-lg-8">
                <div id="divQueryData">
                    <div class="form-group col-xs-12 col-sm-6 col-md-6 col-lg-6">
                        <label class="col-xs-3 col-sm-3 col-md-3 col-lg-3 control-label text-right">WO:</label>
                        <div id="divInputQueryData" class="col-xs-9 col-sm-9 col-md-9 col-lg-9">
                            <input type="text" class="form-control" />
                            <textarea class="form-control" rows="3"></textarea>
                        </div>
                    </div>
                </div>
                <div id="divQueryStatus">
                    <div class="form-group col-xs-12 col-sm-6 col-md-6 col-lg-6">
                        <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">
                            <button type="button" id="btnQuery" class="btn btn-outline btn-primary">
                                <i class="glyphicon glyphicon-search" aria-hidden="true"></i><lan set-lan="html:btnQuery">Query</lan>
                            </button>
                        </div>
                        <div id="divInputQueryData" class="col-xs-9 col-sm-9 col-md-9 col-lg-9">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="tableEventsToolbar">
            <div class="btn-group hidden-xs" role="group" style="padding-bottom:3px;">
                <button type="button" class="btn btn-outline btn-primary" id="btnLock">
                    <i class="fa fa-lock" aria-hidden="true"></i><lan set-lan="html:Lock">Lock</lan>
                </button>
                <button type="button" class="btn btn-outline btn-primary" id="btnUnLock">
                    <i class="fa fa-unlock-alt" aria-hidden="true"></i><lan set-lan="html:UnLock">UnLock</lan>
                </button>
            </div>
        </div>
        <div id="divLockingList">
            <table id="tableLockingList"></table>
        </div>
    </div>
    <div id="divNewLock" class="panel-body form-horizontal">
        <div id="divLockType" class="form-group">
            <label class="col-xs-3 col-sm-3 col-md-3 col-lg-3 control-label text-right" set-lan="html:labelLockType">Lock Type:</label>
            <div class="col-xs-7 col-sm-7 col-md-7 col-lg-7">
                <label class="radio-inline">
                    <input type="radio" name="LockType" value="LockByWo" checked="checked"> By WO
                </label>
                <label class="radio-inline">
                    <input type="radio" name="LockType" value="LockByLot" >By Lot
                </label>
                <label class="radio-inline">
                    <input type="radio" name="LockType" value="LockBySn" > By SN
                </label>
            </div>
        </div>
        <div id="divLockWo" class="form-group">
            <label class="col-xs-3 col-sm-3 col-md-3 col-lg-3 control-label text-right" set-lan="html:labelLockWO">WO:</label>
            <div class="col-xs-7 col-sm-7 col-md-7 col-lg-7">
                <input type="text" id="" class="form-control" set-lan="attr:placeholder=placeholderWO" />
            </div>
        </div>
        <div id="divLockLot" class="form-group">
            <label class="col-xs-3 col-sm-3 col-md-3 col-lg-3 control-label text-right" set-lan="html:labelLockLot">Lot:</label>
            <div class="col-xs-7 col-sm-7 col-md-7 col-lg-7">
                <input type="text" id="" class="form-control" set-lan="attr:placeholder=placeholderLotno" />
            </div>
        </div>
        <div id="divLockSN" class="form-group">
            <label class="col-xs-3 col-sm-3 col-md-3 col-lg-3 control-label text-right" set-lan="html:labelLockSN">SN:</label>
            <div class="col-xs-7 col-sm-7 col-md-7 col-lg-7">
                <textarea class="form-control" rows="10" set-lan="attr:placeholder=placeholderSN"></textarea>
            </div>
        </div>
        <div id="divLockStation" class="form-group">
            <label class="col-xs-3 col-sm-3 col-md-3 col-lg-3 control-label text-right" set-lan="html:labelLockType">Station:</label>
            <div class="col-xs-7 col-sm-7 col-md-7 col-lg-7">
                <select class="form-control">                    
                </select>
            </div>
        </div>
        <div id="divLockReason" class="form-group">
            <label class="col-xs-3 col-sm-3 col-md-3 col-lg-3 control-label text-right" set-lan="html:labelLockReason">Reason:</label>
            <div class="col-xs-7 col-sm-7 col-md-7 col-lg-7">
                <textarea class="form-control" rows="3" set-lan="attr:placeholder=placeholderSN"></textarea>
            </div>
        </div>
        <div id="divDoLock" class="form-group">
            <label class="col-xs-3 col-sm-3 col-md-3 col-lg-3 control-label text-right"></label>
            <div class="col-xs-7 col-sm-7 col-md-7 col-lg-7">
                <button type="button" id="btnDoLock" class="btn btn-outline btn-primary">
                    <i class="fa fa-lock" aria-hidden="true"></i><lan set-lan="html:btnLock">Lock</lan>
                </button>
            </div>
        </div>
    </div>
    <div id="divUnlock" class="panel-body form-horizontal">
        <div id="divUnlockWO" class="form-group">
            <label class="col-xs-3 col-sm-3 col-md-3 col-lg-3 control-label text-right">UnlockWO:</label>
            <div class="col-xs-7 col-sm-7 col-md-7 col-lg-7">
                <textarea class="form-control" rows="2" readonly></textarea>
            </div>
        </div>
        <div id="divUnlockLot" class="form-group">
            <label class="col-xs-3 col-sm-3 col-md-3 col-lg-3 control-label text-right">UnlockLotno:</label>
            <div class="col-xs-7 col-sm-7 col-md-7 col-lg-7">
                <textarea class="form-control" rows="2" readonly></textarea>
            </div>
        </div>
        <div id="divUnlockSN" class="form-group">
            <label class="col-xs-3 col-sm-3 col-md-3 col-lg-3 control-label text-right">UnlockSN:</label>
            <div class="col-xs-7 col-sm-7 col-md-7 col-lg-7">
                <textarea class="form-control" rows="3" readonly></textarea>
            </div>
        </div>
        <div id="divLockReasonReadonly" class="form-group">
            <label class="col-xs-3 col-sm-3 col-md-3 col-lg-3 control-label text-right" set-lan="html:labelLockSN">Lock Reason:</label>
            <div class="col-xs-7 col-sm-7 col-md-7 col-lg-7">
                <textarea class="form-control" rows="3" readonly></textarea>
            </div>
        </div>
        <div id="divUnlockReason" class="form-group">
            <label class="col-xs-3 col-sm-3 col-md-3 col-lg-3 control-label text-right" set-lan="html:labelLockSN">Unlock Reason:</label>
            <div class="col-xs-7 col-sm-7 col-md-7 col-lg-7">
                <textarea class="form-control" rows="3" set-lan="attr:placeholder=placeholderUnlockReason"></textarea>
            </div>
        </div>
        <div id="divDoUnLock" class="form-group">
            <label class="col-xs-3 col-sm-3 col-md-3 col-lg-3 control-label text-right"></label>
            <div class="col-xs-7 col-sm-7 col-md-7 col-lg-7">
                <button type="button" id="btnDoUulock" class="btn btn-outline btn-primary">
                    <i class="fa fa-unlock" aria-hidden="true"></i><lan set-lan="html:btnLock">Unlock</lan>
                </button>
            </div>
        </div>
    </div>

    <!-- 全局js -->
    <script src="../../Scripts/jquery.min.js?v=2.1.4"></script>
    <script src="../../Scripts/jquery.cookie.js"></script>

    <!-- 第三方插件 -->
    <script src="../../Scripts/bootstrap.min.js"></script>
    <script src="../../Scripts/plugins/JSON/json2.js"></script>
    <script src="../../Scripts/plugins/layer/layer.min.js"></script>
    <script src="../../Scripts/plugins/bootstrapTable/bootstrap-table.min.js"></script>
    <script src="../../Scripts/plugins/bootstrapTable/tableExport.min.js"></script>
    <script src="../../Scripts/plugins/bootstrapTable/bootstrap-table-export.js"></script>
    <script src="../../Scripts/plugins/sweetalert/sweetalert.min.js"></script>

    <script src="../../Scripts/global.js"></script>
    <script src="../../Scripts/MesClient.UI.js"></script>
    <script src="../../Scripts/MesClient.js"></script>

    <script type="text/javascript">
       
        var textarea = "";
        var mesUI;
        var lan;
        var arrayID = [];
        var callData;
        $(document).ready(function () {
            $("#divNewLock").addClass("hidden");
            $("#divUnlock").addClass("hidden");
            $("#divInputQueryData").find("textarea").addClass("hidden");
            $("#divInputQueryData").find("input").val("");
            $("#divInputQueryData").find("input").focus();
            
            client = self.parent.client;
            mesUI = new MesClientUI(client);
            lan = $.cookie($.MES.CK_LAN_NAME);
            ShowWoData([]);

            $("#divQueryType").find("input[name=QueryType]").click(function () {
                if ($(this).val() == "ByWo") {
                    $("#divQueryData").find("label").html("WO:")
                    $("#divInputQueryData").find("textarea").addClass("hidden");
                    $("#divInputQueryData").find("input").removeClass("hidden");
                    $("#divInputQueryData").find("input").val("");
                    $("#divInputQueryData").find("input").focus();
                }
                else if ($(this).val() == "ByLot") {
                    $("#divQueryData").find("label").html("LOT:")
                    $("#divInputQueryData").find("textarea").addClass("hidden");
                    $("#divInputQueryData").find("input").removeClass("hidden");
                    $("#divInputQueryData").find("input").val("");
                    $("#divInputQueryData").find("input").focus();
                }
                else if ($(this).val() == "BySn") {
                    $("#divQueryData").find("label").html("SN:")
                    $("#divInputQueryData").find("textarea").removeClass("hidden");
                    $("#divInputQueryData").find("input").addClass("hidden");
                    $("#divInputQueryData").find("textarea").val("");
                    $("#divInputQueryData").find("textarea").focus();
                }
            });

            $("#btnQuery").on("click", function () {
                var queryType = $("#divQueryType").find("input[name=QueryType]:checked").val();
                var queryData = "";
                var queryStatus = $("#divQueryStatus").find("select  option:selected").val();                
                if (queryType == "ByWo" || queryType == "ByLot") {
                    queryData = $("#divInputQueryData").find("input").val();
                }
                else {
                    queryData = $("#divInputQueryData").find("textarea").val().split("\n");
                }
                if (queryData == "" || queryData == undefined) {
                    layer.msg("Please input Query Data!", {
                        icon: 2,
                        time: 3000
                    }, function () { });
                    return;
                }
                SearchLockInfo(queryType, queryData, queryStatus);
            })

            $("#btnLock").on("click", function () {
                layer.open({
                    type: 1,
                    title: 'New Lock',
                    area: ["60%", "80%"],
                    scrollbar: false,
                    content: $("#divNewLock"),
                    success: function (layero, index) {
                        $("#divNewLock").removeClass("hidden");
                        $("#divLockWo").removeClass("hidden");
                        $("#divLockWo").find("input[type=text]").val("");
                        $("#divLockWo").find("input[type=text]").focus();
                        $("#divLockWo").find("input[type=text]").select();
                        $("#divLockLot").addClass("hidden");
                        $("#divLockSN").addClass("hidden");

                        $("input:radio[name='LockType']").attr("checked", false);
                        $("input:radio[name='LockType']").eq(0).prop("checked", true);    
                        $($("#divLockStation").find("select")).find("option:selected").text("");
                        $($("#divLockStation").find("select")).empty();
                        $("#divLockReason").find("textarea").val("");
                    },
                    end: function () {
                        $("#divNewLock").addClass("hidden");
                    }
                });
            });

            $("#divLockType").find("input[name=LockType]").click(function () {
                if ($(this).val() == "LockByWo") {
                    $("#divLockWo").removeClass("hidden");
                    $("#divLockWo").find("input[type=text]").val("");
                    $("#divLockWo").find("input[type=text]").focus();
                    $("#divLockWo").find("input[type=text]").select();
                    $("#divLockLot").addClass("hidden");
                    $("#divLockSN").addClass("hidden");
                    $("#divLockReason").find("textarea").val("");

                    $($("#divLockStation").find("select")).find("option:selected").text("");
                    $($("#divLockStation").find("select")).empty();
                }
                else if ($(this).val() == "LockByLot") {
                    $("#divLockWo").addClass("hidden");
                    $("#divLockLot").removeClass("hidden");
                    $("#divLockLot").find("input[type=text]").val("");
                    $("#divLockLot").find("input[type=text]").focus();
                    $("#divLockLot").find("input[type=text]").select();
                    $("#divLockSN").addClass("hidden");
                    $("#divLockReason").find("textarea").val("");

                    $($("#divLockStation").find("select")).find("option:selected").text("");
                    $($("#divLockStation").find("select")).empty();
                }
                else if ($(this).val() == "LockBySn") {
                    $("#divLockWo").addClass("hidden");
                    $("#divLockLot").addClass("hidden");
                    $("#divLockSN").removeClass("hidden");
                    $("#divLockSN").find("textarea").val("");
                    $("#divLockSN").find("textarea").focus();
                    $("#divLockSN").find("textarea").select();
                    $("#divLockReason").find("textarea").val("");

                    $($("#divLockStation").find("select")).find("option:selected").text("");
                    $($("#divLockStation").find("select")).empty();
                    GetLockStation("", "");
                }
            });

            $("#divLockWo").find("input").keypress(function (event) {
                if (event.keyCode == 13) {
                    GetLockStation("LockByWo", $("#divLockWo").find("input").val());
                }
            });

            $("#divLockLot").find("input").keypress(function (event) {
                if (event.keyCode == 13) {
                    GetLockStation("LockByLot", $("#divLockLot").find("input").val());
                }
            });

            $("#btnDoLock").on("click", function () {
                var lockType = $("#divLockType").find("input[name=LockType]:checked").val();
                var lockStation = $("#divLockStation").find("select  option:selected").val();
                var lockData = "";
                var lockReason = "";
                
                if (lockStation == "" || lockStation == undefined) {
                    layer.msg("Please select lock station ", {
                        icon: 2,
                        time: 3000
                    }, function () { });
                    return;
                }

                if (lockType == "LockByWo") {
                    if ($("#divLockWo").find("input[type=text]").val() == "") {

                        layer.msg("Please input WO!", {
                            icon: 2,
                            time: 3000
                        }, function () { });
                        return;
                    }
                    else {
                        lockData = $("#divLockWo").find("input[type=text]").val();
                    }
                }
                else if (lockType == "LockByLot") {
                    if ($("#divLockLot").find("input[type=text]").val() == "") {
                        layer.msg("Please input lotno!", {
                            icon: 2,
                            time: 3000
                        }, function () { });
                        return;
                    } else {
                        lockData = $("#divLockLot").find("input[type=text]").val();
                    }
                } else if (lockType == "LockBySn") {
                    if ($("#divLockSN").find("textarea").val() == "") {
                        layer.msg("Please input SN!", {
                            icon: 2,
                            time: 3000
                        }, function () { });
                        return;
                    } else {
                        lockData = $("#divLockSN").find("textarea").val().split("\n");
                    }
                } else {
                    layer.msg("Please select lock type!", {
                        icon: 2,
                        time: 3000
                    }, function () { });
                    return;
                }

                if ($("#divLockReason").find("textarea").val() == "") {
                    layer.msg("Please input reason!", {
                        icon: 2,
                        time: 3000
                    }, function () { });
                    return;
                }
                else {
                    lockReason = $("#divLockReason").find("textarea").val();
                }

                callData = { "LockType": lockType, "LockData": lockData, "LockStation": lockStation, "LockReason": lockReason };
                client.CallFunction("MESStation.Management.LockManager", "DoLock", callData, function (e) {
                    if (e.Status == "Pass") {                       
                        if (lockType == "LockByWo") {
                            SearchLockInfo("BYWO", lockData, "1");
                        } else if (lockType == "LockByLot") {
                            SearchLockInfo("BYLOT", lockData, "1");
                        }
                        else if (lockType == "LockBySn") {
                            SearchLockInfo("BYSN", lockData, "1");
                        }
                        layer.closeAll("page");
                    } else {
                        layer.msg(e.Message, {
                            icon: 2,
                            time: 3000
                        }, function () {
                        });
                    }
                });
            });

            $("#btnUnLock").on("click", function () {
                var tempLockLot = "";
                var tempWo = "";
                var tempSN = "";
                var alertMsg = "";
                var tempReason = "";
                var arrayLockLot = [];
                var arrayWO = [];
                var arraySN = [];
                var arrayLockReason = [];
                arrayID.splice(0, arrayID.length);

                var selectRows = $('#tableLockingList').bootstrapTable('getAllSelections');
                if (selectRows.length <= 0) {
                    layer.msg("no records selected", {
                        icon: 2,
                        time: 3000
                    }, function () { });
                    return;
                }
                for (var i = 0; i < selectRows.length; i++) {
                    if (selectRows[i].LOCK_STATUS == "0") {
                        layer.msg(selectRows[i].SN+" have been unlock", {
                            icon: 2,
                            time: 3000
                        }, function () { });
                        return;
                    }

                    if (selectRows[i].LOCK_LOT != undefined && selectRows[i].LOCK_LOT != "") {
                        arrayLockLot.push(selectRows[i].LOCK_LOT);
                    }
                    if (selectRows[i].WORKORDERNO != undefined && selectRows[i].WORKORDERNO != "") {
                        arrayWO.push(selectRows[i].WORKORDERNO);
                    }
                    if (selectRows[i].SN != undefined && selectRows[i].SN != "") {
                        arraySN.push(selectRows[i].SN);
                    }
                    if (selectRows[i].LOCK_REASON != undefined && selectRows[i].LOCK_REASON != "") {
                        arrayLockReason.push(selectRows[i].LOCK_REASON);
                    }
                    arrayID.push(selectRows[i].ID);

                }
                //去重複
                $.unique(arrayLockLot);
                $.unique(arrayWO);
                $.unique(arraySN);
                $.unique(arrayLockReason);

                if (arrayLockReason.length > 1) {
                    $.each(arrayLockReason, function (index, value) {
                        tempReason = tempReason + value + "</br>";
                    });

                    layer.msg("More Reason. </br>" + tempReason, {
                        icon: 2,
                        time: 6000
                    }, function () { });
                    return;
                }
                else {
                    tempReason = arrayLockReason[0];
                }

                if (arrayLockLot.length > 1) {
                    alertMsg = alertMsg + "More lock_lot,";
                    $.each(arrayLockLot, function (index, value) {
                        if (index == arrayLockLot.length - 1) {
                            tempLockLot = tempLockLot + value;
                        }
                        else {
                            tempLockLot = tempLockLot + value + "\n";
                        }
                    });
                }
                else {
                    tempLockLot = arrayLockLot[0];
                }

                if (arrayWO.length > 1) {
                    alertMsg = alertMsg + "More WO,";
                    $.each(arrayWO, function (index, value) {
                        if (index == arrayWO.length - 1) {
                            tempWo = tempWo + value;
                        }
                        else {
                            tempWo = tempWo + value + "\n";
                        }
                    });
                }
                else {
                    tempWo = arrayWO[0];
                }
                
                if (arraySN.length > 1) {
                    alertMsg = alertMsg + "More SN.";
                    $.each(arraySN, function (index, value) {
                        if (index == arraySN.length - 1) {
                            tempSN = tempSN + value;
                        }
                        else {
                            tempSN = tempSN + value + "\n";
                        }
                    });
                }
                else {
                    tempSN = arraySN[0];
                }

                if (alertMsg != "") {
                    swal({
                        title: alertMsg + "Are you sure to unlock these data?",
                        text: "",
                        type: "warning",
                        showCancelButton: true,
                        closeOnConfirm: false,
                        confirmButtonText: "YES",
                        confirmButtonColor: "#18a689"
                    }, function () {
                        layer.open({
                            type: 1,
                            title: 'Unlock',
                            area: ["60%", "80%"],
                            scrollbar: false,
                            content: $("#divUnlock"),
                            success: function (layero, index) {
                                $("#divUnlock").removeClass("hidden");
                                $("#divUnlockWO").find("textarea").val(tempWo);
                                $("#divUnlockLot").find("textarea").val(tempLockLot);
                                $("#divUnlockSN").find("textarea").val(tempSN);
                                $("#divLockReasonReadonly").find("textarea").val(tempReason);
                                $("#divUnlockReason").find("textarea").val("");
                                $("#divUnlockReason").find("textarea").select();
                                $("#divUnlockReason").find("textarea").focus();
                            },
                            end: function () {
                                $("#divUnlock").addClass("hidden");
                            }
                        });
                        swal.close();
                    });
                }
                else {
                    layer.open({
                        type: 1,
                        title: 'Unlock',
                        area: ["60%", "80%"],
                        scrollbar: false,
                        content: $("#divUnlock"),
                        success: function (layero, index) {
                            $("#divUnlock").removeClass("hidden");
                            $("#divUnlockWO").find("textarea").val(tempWo);
                            $("#divUnlockLot").find("textarea").val(tempLockLot);
                            $("#divUnlockSN").find("textarea").val(tempSN);
                            $("#divLockReasonReadonly").find("textarea").val(tempReason);
                            $("#divUnlockReason").find("textarea").val("");
                            $("#divUnlockReason").find("textarea").select();
                            $("#divUnlockReason").find("textarea").focus();
                        },
                        end: function () {
                            $("#divUnlock").addClass("hidden");
                        }
                    });
                }

            });

            $("#btnDoUulock").on("click", function () {
                var unlockReason = "";
                if ($("#divUnlockReason").find("textarea").val() == "") {
                    layer.msg("Please input unlock reason!", {
                        icon: 2,
                        time: 3000
                    }, function () { });
                    return;
                }
                else {
                    unlockReason = $("#divUnlockReason").find("textarea").val();
                }
                if (arrayID.length == 0) {
                    layer.msg("no records selected!", {
                        icon: 2,
                        time: 3000
                    }, function () { });
                    return;
                }
                callData = { "ID": arrayID, "UnlockReason": unlockReason};
                client.CallFunction("MESStation.Management.LockManager", "DoUnlock", callData, function (e) {
                    if (e.Status == "Pass") {
                        SearchLockInfo("BYID", arrayID, "0");
                        layer.closeAll("page");           
                    } else {
                        layer.msg(e.Message, {
                            icon: 2,
                            time: 3000
                        }, function () {
                        });
                    }
                });
            });
        });

        function ShowWoData(Data) {
            var localeLan = $.cookie($.MES.CK_LAN_NAME);            
            if (localeLan == "CHINESE") {
                localeLan = "zh-CN"
            }
            else if (localeLan == "CHINESE_TW") {
                localeLan = "zh-TW"
            }
            else {
                localeLan = "en"
            }

            $('#tableLockingList').bootstrapTable({
                data: Data,
                striped: false,                    //是否显示行间隔色
                cache: false,                      //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
                sortable: false,                   //是否启用排序
                sortOrder: "asc",                  //排序方式
                pagination: false,                  //是否显示分页（*）
                sidePagination: "client",          //分页方式：client客户端分页，server服务端分页（*）
                pageNumber: 1,                     //初始化加载第一页，默认第一页
                pageSize: 5,                       //每页的记录行数（*）
                pageList: [5, 20, 60, 100],        //可供选择的每页的行数（*）
                showColumns: false,                 //是否显示 内容列下拉框
                showRefresh: true,                 //是否显示刷新按钮
                maintainSelected: true,
                minimumCountColumns: 2,            //最少允许的列数
                clickToSelect: true,               //是否启用点击选中行
                singleSelect: false,                //单选checkbox
                showToggle: false,                  //是否显示详细视图和列表视图的切换按钮
                cardView: false,                   //是否显示详细视图
                detailView: false,                 //是否显示父子表
                search: true,                      //是否显示表格搜索，此搜索是客户端搜索，不会进服务端，
                strictSearch: false,               //设置为 true启用 全匹配搜索，否则为模糊搜索
                searchOnEnterKey: false,            //回车搜索
                searchTimeOut: 500,                //设置搜索超时时间
                trimOnSearch: true,                //设置为 true 将允许空字符搜索
                searchAlign: "left",              //查询框对齐方式
                toolbar: "#tableEventsToolbar",    //指定工具栏
                toolbarAlign: "left",              //工具栏对齐方式
                buttonsAlign: "right",             //按钮对齐方式
                showExport: false,                  //是否显示导出按钮
                exportDataType: 'all',             //'basic', 'all', 'selected'  exportDataType表示导出的模式是当前页、所有数据还是选中数据
                exportTypes: ['excel', 'csv'],     //导出文件类型
                Icons: 'glyphicon-export',
                exportOptions: {
                    ignoreColumn: [0],             //忽略某一列的索引
                    fileName: 'LockingList',     //文件名称设置
                    worksheetName: 'sheet1',       //表格工作区名称
                },
                locale: localeLan,
                columns: [{
                    field: 'select',
                    title: 'select',
                    checkbox: true
                },
                {
                    field: "ID",
                    title: "ID",
                    visible: false
                },
                {
                    field: 'TYPE',
                    title: 'TYPE',
                    rowspan: 1,
                    align: 'center',
                    valign: 'middle',
                    sortable: true,
                    visible: true
                },
                {
                    field: 'WORKORDERNO',
                    title: 'WORKORDERNO',
                    rowspan: 1,
                    align: 'center',
                    valign: 'middle',
                    sortable: true,
                    visible: true
                }, {
                    field: 'LOCK_LOT',
                    title: 'LOCK_LOT',
                    rowspan: 1,
                    align: 'center',
                    valign: 'middle',
                    sortable: true,
                    visible: true
                }, {
                    field: 'SN',
                    title: 'SN',
                    rowspan: 1,
                    align: 'center',
                    valign: 'middle',
                    sortable: true,
                    visible: true
                },
                {
                    field: 'LOCK_STATION',
                    title: 'LOCK_STATION',
                    rowspan: 1,
                    align: 'center',
                    valign: 'middle',
                    sortable: true,
                    visible: true
                }, {
                    field: 'LOCK_STATUS',
                    title: 'LOCK_STATUS',
                    rowspan: 1,
                    align: 'center',
                    valign: 'middle',
                    sortable: true,
                    visible: true
                }, {
                    field: 'LOCK_REASON',
                    title: 'LOCK_REASON',
                    rowspan: 1,
                    align: 'center',
                    valign: 'middle',
                    sortable: true,
                    visible: true
                }, {
                    field: 'UNLOCK_REASON',
                    title: 'UNLOCK_REASON',
                    rowspan: 1,
                    align: 'center',
                    valign: 'middle',
                    sortable: true,
                    visible: true
                }, {
                    field: 'LOCK_EMP',
                    title: 'LOCK_EMP',
                    rowspan: 1,
                    align: 'center',
                    valign: 'middle',
                    sortable: true,
                    visible: true
                }, {
                    field: 'LOCK_TIME',
                    title: 'LOCK_TIME',
                    rowspan: 1,
                    align: 'center',
                    valign: 'middle',
                    sortable: true,
                    visible: true
                }, {
                    field: 'UNLOCK_EMP',
                    title: 'UNLOCK_EMP',
                    rowspan: 1,
                    align: 'center',
                    valign: 'middle',
                    sortable: true,
                    visible: true
                }, {
                    field: 'UNLOCK_TIME',
                    title: 'UNLOCK_TIME',
                    rowspan: 1,
                    align: 'center',
                    valign: 'middle',
                    sortable: true,
                    visible: true
                }]
            });
        }

        function SearchLockInfo(queryType, queryData, queryStatus) {
            callData = { "Type": queryType, "Data": queryData, "Status": queryStatus };
            client.CallFunction("MESStation.Management.LockManager", "GetLockInfo", callData, function (e) {
                if (e.Status == "Pass") {
                    $('#tableLockingList').bootstrapTable("load", e.Data);
                } else {
                    layer.msg(e.Message, {
                        icon: 2,
                        time: 3000
                    }, function () {
                    });
                }
            });
        }

        function GetLockStation(lockType, lockData) {
            callData = { "LockType": lockType, "LockData": lockData };
            client.CallFunction("MESStation.Management.LockManager", "GetLockStation", callData, function (e) {
                if (e.Status == "Pass") {
                    var temp = e.Data;
                    $.each(e.Data, function (index, value) {
                        $($("#divLockStation").find("select")).append("<option value='" + value + "'>" + value + "</option>");
                    });
                } else {
                    layer.msg(e.Message, {
                        icon: 2,
                        time: 3000
                    }, function () {
                    });
                }
            });
        }        
    </script>
</body>
</html>
